package com.wipro.training.bank.service;

import java.time.LocalDateTime;

import org.springframework.stereotype.Service;

import com.wipro.training.bank.controller.dao.AdminRequest;
import com.wipro.training.bank.model.Account;
import com.wipro.training.bank.model.Admin;
import com.wipro.training.bank.repository.AccountRepository;

/*
Author-Abhinav Kumar
Date-Sep 13, 2024
Time-9:37:56â€¯AM
Project-daily-bank
 */

@Service
public class AdminService {

	private final AccountRepository accountRepository;

	public AdminService(AccountRepository accountRepository) {
		this.accountRepository = accountRepository;
	}

	public Admin creditMoney(AdminRequest request) {
		Account account = accountRepository.findByAccountNumber(request.getAccountNumber());
		Admin admin = account.getAdmin();
		admin.setCreditAmount(request.getAmount());
		admin.setTotalAmount(admin.getTotalAmount() + request.getAmount());
		admin.setTransactionTime(LocalDateTime.now());
		accountRepository.save(account);
		return admin;
	}

	public Admin debitMoney(AdminRequest request) {
		Account account = accountRepository.findByAccountNumber(request.getAccountNumber());
		Admin admin = account.getAdmin();
		admin.setDebitAmount(request.getAmount());
		admin.setTotalAmount(admin.getTotalAmount() - request.getAmount());
		admin.setTransactionTime(LocalDateTime.now());
		accountRepository.save(account);
		return admin;
	}

}
